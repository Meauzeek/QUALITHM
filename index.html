<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUALITHM: ENDFIELD PROTOCOL</title>
    <!-- Fonts: Rajdhani for Tech UI, Noto Sans JP for text -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;700&family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- Background Decoration Layers -->
    <div class="bg-deco-grid"></div>
    <div class="bg-deco-line"></div>
    <div class="ui-corner-tl">SYSTEM: ONLINE</div>
    <div class="ui-corner-br">VER. 4.0.2</div>

    <!-- Dev Mode Toggle -->
    <div class="dev-toggle" id="devToggle">
        <i class="fa-solid fa-terminal"></i>
        <span>DEBUG</span>
    </div>

    <div id="app">
        
        <!-- Scene: Main Menu -->
        <section id="scene-menu" class="scene active">
            <div class="menu-layout">
                <div class="hero-text-container">
                    <h1 class="logo glitch-effect" data-text="QUALITHM">QUALITHM</h1>
                    <div class="deco-bar"></div>
                    <p class="subtitle">PROTOCOL: FADING WORLD // RECONSTRUCTION</p>
                </div>
                
                <div class="juni-wrapper tilted-element">
                    <img src="https://placehold.co/400x700/transparent/333?text=Juni" alt="Juni" class="juni-img">
                    <div class="dialogue-card glass-panel">
                        <div class="deco-corner"></div>
                        <p>"Doctor... the frequency data is fragmented. Awaiting input."</p>
                    </div>
                </div>

                <button class="btn-main-action" onclick="SceneManager.switch('category')">
                    <span class="btn-text">INITIATE LINK</span>
                    <span class="btn-deco">>>></span>
                </button>
            </div>
        </section>

        <!-- Scene: Category Select -->
        <section id="scene-category" class="scene">
            <div class="scene-header">
                <button class="btn-back" onclick="SceneManager.switch('menu')">
                    <i class="fa-solid fa-chevron-left"></i> BACK
                </button>
                <div class="header-title">
                    <h2>DATABASE SELECTION</h2>
                    <span>Select Archive Source</span>
                </div>
            </div>
            
            <div class="category-scroll-area">
                <div class="category-track" id="categoryGrid">
                    <!-- Categories injected by JS -->
                </div>
            </div>
        </section>

        <!-- Scene: Music Select -->
        <section id="scene-music" class="scene">
            <div class="top-nav glass-panel">
                <button class="btn-back-icon" onclick="SceneManager.switch('category')"><i class="fa-solid fa-arrow-left"></i></button>
                <div class="search-box">
                    <i class="fa-solid fa-magnifying-glass"></i>
                    <input type="text" id="searchInput" placeholder="SEARCH FREQUENCY...">
                </div>
                <div class="filter-tag" id="filterDisplay">ALL</div>
            </div>

            <div class="workspace">
                <!-- Left: List -->
                <div class="list-zone">
                    <div class="list-decoration">TRACK LIST // <span id="countDisplay">00</span></div>
                    <div class="song-list-scroll" id="songList">
                        <!-- JS Injection -->
                    </div>
                </div>

                <!-- Right: Detail -->
                <div class="detail-zone" id="songDetail">
                    
                    <div class="jacket-stage tilted-element">
                        <div class="jacket-frame">
                            <img id="detailCover" src="" alt="Cover">
                            <div class="jacket-overlay"></div>
                        </div>
                        <!-- Difficulty Badge (Floating) -->
                        <div class="diff-badge-float" id="detailDiffBadge">
                            <span class="badge-label" id="diffLabel">MET</span>
                            <span class="badge-val" id="diffVal">14+</span>
                        </div>
                    </div>

                    <div class="info-panel glass-panel">
                        <div class="panel-deco-line"></div>
                        <h1 id="detailTitle">Title</h1>
                        <h2 id="detailArtist">Artist</h2>
                        
                        <div class="stats-row">
                            <div class="stat-item">
                                <span class="label">BPM</span>
                                <span class="val" id="detailBpm">150</span>
                            </div>
                            <div class="stat-item">
                                <span class="label">OFFSET</span>
                                <span class="val">0ms</span>
                            </div>
                        </div>

                        <!-- Tabs -->
                        <div class="difficulty-selector" id="diffTabs">
                            <!-- JS Injection -->
                        </div>

                        <div class="action-bar">
                            <button class="btn-play">
                                <span class="icon"><i class="fa-solid fa-play"></i></span>
                                <span class="txt">START OPERATION</span>
                            </button>
                            <button class="btn-edit hidden" id="btnEditSong">
                                <i class="fa-solid fa-pen-to-square"></i> EDIT
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Edit Modal (Tech Style) -->
    <div class="modal-overlay" id="editModal">
        <div class="modal-window">
            <div class="modal-header">
                <h3>OVERWRITE_DATA // EDIT</h3>
                <button onclick="Editor.close()" class="btn-close"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <form id="editForm">
                <input type="hidden" id="editId">
                
                <div class="form-row">
                    <div class="form-group flex-2">
                        <label>TITLE (Override for HYP/WMS)</label>
                        <input type="text" id="editTitle">
                    </div>
                    <div class="form-group flex-1">
                        <label>ARTIST</label>
                        <input type="text" id="editArtist">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group flex-1">
                        <label>COVER URL</label>
                        <input type="text" id="editCover">
                    </div>
                </div>

                <div class="separator">DIFFICULTY CONFIG</div>

                <div class="form-row">
                    <div class="form-group">
                        <label>CURRENT LEVEL (Float)</label>
                        <input type="number" step="0.1" id="editLevel">
                    </div>
                    
                    <!-- New Toggles -->
                    <div class="toggle-group">
                        <label class="checkbox-container">
                            <input type="checkbox" id="checkHyp">
                            <span class="checkmark"></span>
                            ENABLE HYPER
                        </label>
                        <label class="checkbox-container">
                            <input type="checkbox" id="checkWms">
                            <span class="checkmark"></span>
                            ENABLE WHIMSY
                        </label>
                    </div>
                </div>

                <!-- WMS Special Input -->
                <div class="form-group hidden" id="wmsGroup">
                    <label>WHIMSY LABEL (e.g. ç‹‚, ?, X)</label>
                    <input type="text" id="editWmsLabel" maxlength="4">
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn-modal-cancel" onclick="Editor.close()">ABORT</button>
                    <button type="submit" class="btn-modal-save">CONFIRM WRITE</button>
                </div>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>